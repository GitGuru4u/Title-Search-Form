<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Title Search Data Entry</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css"> 
</head>
<body>

    <div class="container my-5">
        <header class="text-center mb-5">
            <h1 id="main-title">Title Search Data Entry Form</h1>
            <p class="lead">Systematic capture of property and document information for preliminary reports.</p>
        </header>

        <div class="form-container">
            <form id="dataEntryForm">

                <fieldset id="property-fields" class="mb-4 p-4 border rounded">
                    <legend class="float-none w-auto px-2"><i class="bi bi-geo-alt-fill me-2"></i> Property & Search Fields</legend>
                    
                    <div class="row g-3 pt-4">
                        <div class="col-md-3">
                            <label for="order-no" class="form-label">Order No.</label>
                            <input type="text" id="order-no" name="order-no" class="form-control" data-excel-field="Order No." oninput="saveFormData()">
                        </div>
                        <div class="col-md-5">
                            <label for="owner-name" class="form-label">Owner Name(s)</label>
                            <input type="text" id="owner-name" name="owner-name" class="form-control" data-excel-field="Owner Name" oninput="saveFormData()">
                        </div>
                        <div class="col-md-4">
                            <label for="effective-date" class="form-label">Effective Date</label>
                            <input type="date" id="effective-date" name="effective-date" class="form-control" data-excel-field="Effective Date" oninput="saveFormData()">
                        </div>
                    </div>

                    <div class="row g-3 my-3">
                        <div class="col-md-6">
                            <label for="prop-address" class="form-label">Property Address</label>
                            <input type="text" id="prop-address" name="prop-address" class="form-control" data-excel-field="Prop. Address" oninput="saveFormData()">
                        </div>
                        <div class="col-md-3">
                            <label for="county" class="form-label">County</label>
                            <input type="text" id="county" name="county" class="form-control" data-excel-field="County" oninput="saveFormData()">
                        </div>
                        <div class="col-md-3">
                            <label for="state" class="form-label">State</label>
                            <input type="text" id="state" name="state" class="form-control" data-excel-field="State" oninput="saveFormData()">
                        </div>
                    </div>
                    
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label for="apn-parcel-id" class="form-label">APN / Parcel ID</label>
                            <input type="text" id="apn-parcel-id" name="apn-parcel-id" class="form-control" data-excel-field="APN/Parcel ID" oninput="saveFormData()">
                        </div>
                        <div class="col-md-4">
                            <label for="short-legal-lot" class="form-label">Short Legal (Lot)</label>
                            <input type="text" id="short-legal-lot" name="short-legal-lot" class="form-control" data-excel-field="Short Legal Lot" oninput="saveFormData()">
                        </div>
                        <div class="col-md-4">
                            <label for="short-legal-block" class="form-label">Short Legal (Block)</label>
                            <input type="text" id="short-legal-block" name="short-legal-block" class="form-control" data-excel-field="Short Legal Block" oninput="saveFormData()">
                        </div>
                    </div>
                    <div class="mb-3 mt-3">
                        <label for="legal-description-ref" class="form-label">Full Legal Description Reference (Optional)</label>
                        <textarea id="legal-description-ref" name="legal-description-ref" class="form-control" data-excel-field="Legal Description Ref" oninput="saveFormData()"></textarea>
                    </div>
                </fieldset>

                <div class="mb-4" id="taxes-1-wrapper">
                    <div class="section-header p-2 bg-light border rounded-top cursor-pointer" data-bs-toggle="collapse" data-bs-target="#taxes1Collapse" aria-expanded="false" aria-controls="taxes1Collapse">
                        <legend class="mb-0 fs-5"><i class="bi bi-cash-stack me-2"></i> Taxes / Assessments Information - 1</legend>
                    </div>
                    <div class="collapse section-body p-4 border border-top-0 rounded-bottom" id="taxes1Collapse">
                        <fieldset class="tax-section" data-doc-type="Taxes-1">
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label for="tax1-fiscal-year" class="form-label">Fiscal Year:</label>
                                    <select id="tax1-fiscal-year" name="tax1-fiscal-year" class="form-select tax-year-select" data-excel-field="Tax 1 - Fiscal Year" onchange="toggleUnpaidTaxFields(1); saveFormData()"></select>
                                </div>
                                <div class="col-md-4">
                                    <label for="tax1-status" class="form-label">Tax Status:</label>
                                    <select id="tax1-status" name="tax1-status" class="form-select" onchange="toggleUnpaidTaxFields(1); saveFormData()" data-excel-field="Tax 1 - Status">
                                        <option value="">--Select Status--</option>
                                        <option value="Paid">Paid</option>
                                        <option value="Unpaid">Unpaid</option>
                                        <option value="Exempt">Exempt</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="tax1-amount" class="form-label">Tax Amount:</label>
                                    <div class="input-group">
                                        <span class="input-group-text">$</span>
                                        <input type="number" step="0.01" id="tax1-amount" name="tax1-amount" class="form-control" data-excel-field="Tax 1 - Amount" oninput="saveFormData()">
                                    </div>
                                </div>
                            </div>
                            <div class="mt-3" id="tax1-unpaid-year-group">
                                <label for="tax1-unpaid-year" class="form-label">If Unpaid, which year(s) are unpaid?</label>
                                <input type="text" id="tax1-unpaid-year" name="tax1-unpaid-year" class="form-control" data-excel-field="Tax 1 - Unpaid Year(s)" oninput="saveFormData()">
                            </div>
                            <div class="mt-3" id="tax1-comments-group">
                                <label for="tax1-comments" class="form-label">Comments:</label>
                                <textarea id="tax1-comments" name="tax1-comments" class="form-control" data-excel-field="Tax 1 - Comments" oninput="saveFormData()"></textarea>
                            </div>
                        </fieldset>
                    </div>
                </div>

                <div id="additionalTaxes"></div>
                <div class="text-start mb-4 ps-3">
                    <button type="button" class="btn btn-outline-info btn-sm" onclick="addTaxSection()">
                        <i class="bi bi-plus-circle me-1"></i> Add Another Tax/Assessment
                    </button>
                </div>
                
                <div class="mb-4">
                    <div class="section-header active p-2 bg-light border rounded-top cursor-pointer" data-bs-toggle="collapse" data-bs-target="#deed1Collapse" aria-expanded="true" aria-controls="deed1Collapse">
                        <legend class="mb-0 fs-5"><i class="bi bi-file-earmark-text-fill me-2"></i> Document Type: Vesting Deed (Current) - 1</legend>
                    </div>
                    <div class="collapse show section-body p-4 border border-top-0 rounded-bottom" id="deed1Collapse">
                        <fieldset class="deed-section" data-doc-type="Deed-1">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="deed1-grantor" class="form-label">Grantor (Seller):</label>
                                    <input type="text" id="deed1-grantor" name="deed1-grantor" class="form-control" data-excel-field="Deed - Grantor" oninput="saveFormData()">
                                </div>
                                <div class="col-md-6">
                                    <label for="deed1-grantee" class="form-label">Grantee (Buyer/Current Owner):</label>
                                    <input type="text" id="deed1-grantee" name="deed1-grantee" class="form-control" data-excel-field="Deed - Grantee" oninput="saveFormData()">
                                </div>
                            </div>
                            <div class="row g-3 my-3">
                                <div class="col-md-4">
                                    <label for="deed1-dated-date" class="form-label">Dated Date:</label>
                                    <input type="date" id="deed1-dated-date" name="deed1-dated-date" class="form-control" data-excel-field="Deed - Dated Date" oninput="saveFormData()">
                                </div>
                                <div class="col-md-4">
                                    <label for="deed1-recording-date" class="form-label">Recording Date:</label>
                                    <input type="date" id="deed1-recording-date" name="deed1-recording-date" class="form-control" data-excel-field="Deed - Recording Date" oninput="saveFormData()">
                                </div>
                                <div class="col-md-4">
                                    <label for="deed1-inst-no" class="form-label">Inst. No. / Book/Page:</label>
                                    <input type="text" id="deed1-inst-no" name="deed1-inst-no" class="form-control" data-excel-field="Deed - Inst. No." oninput="saveFormData()">
                                </div>
                            </div>
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label for="deed1-consideration" class="form-label">Consideration Amount:</label>
                                    <div class="input-group">
                                        <span class="input-group-text">$</span>
                                        <input type="number" step="0.01" id="deed1-consideration" name="deed1-consideration" class="form-control" data-excel-field="Deed - Consideration Amount" oninput="saveFormData()">
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                </div>

                <div class="mb-4">
                    <div class="section-header p-2 bg-light border rounded-top cursor-pointer" data-bs-toggle="collapse" data-bs-target="#priorDeed1Collapse" aria-expanded="false" aria-controls="priorDeed1Collapse">
                        <legend class="mb-0 fs-5"><i class="bi bi-arrow-return-left me-2"></i> Document Type: Prior Deed - 1</legend>
                    </div>
                    <div class="collapse section-body p-4 border border-top-0 rounded-bottom" id="priorDeed1Collapse">
                        <fieldset class="deed-section" data-doc-type="Prior-Deed-1">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="priorDeed1-grantor" class="form-label">Grantor (Seller):</label>
                                    <input type="text" id="priorDeed1-grantor" name="priorDeed1-grantor" class="form-control" data-excel-field="Prior Deed - Grantor" oninput="saveFormData()">
                                </div>
                                <div class="col-md-6">
                                    <label for="priorDeed1-grantee" class="form-label">Grantee (Buyer/Previous Owner):</label>
                                    <input type="text" id="priorDeed1-grantee" name="priorDeed1-grantee" class="form-control" data-excel-field="Prior Deed - Grantee" oninput="saveFormData()">
                                </div>
                            </div>
                            <div class="row g-3 my-3">
                                <div class="col-md-4">
                                    <label for="priorDeed1-dated-date" class="form-label">Dated Date:</label>
                                    <input type="date" id="priorDeed1-dated-date" name="priorDeed1-dated-date" class="form-control" data-excel-field="Prior Deed - Dated Date" oninput="saveFormData()">
                                </div>
                                <div class="col-md-4">
                                    <label for="priorDeed1-recording-date" class="form-label">Recording Date:</label>
                                    <input type="date" id="priorDeed1-recording-date" name="priorDeed1-recording-date" class="form-control" data-excel-field="Prior Deed - Recording Date" oninput="saveFormData()">
                                </div>
                                <div class="col-md-4">
                                    <label for="priorDeed1-inst-no" class="form-label">Inst. No. / Book/Page:</label>
                                    <input type="text" id="priorDeed1-inst-no" name="priorDeed1-inst-no" class="form-control" data-excel-field="Prior Deed - Inst. No." oninput="saveFormData()">
                                </div>
                            </div>
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label for="priorDeed1-consideration" class="form-label">Consideration Amount:</label>
                                    <div class="input-group">
                                        <span class="input-group-text">$</span>
                                        <input type="number" step="0.01" id="priorDeed1-consideration" name="priorDeed1-consideration" class="form-control" data-excel-field="Prior Deed - Consideration Amount" oninput="saveFormData()">
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                </div>
                
                <hr class="my-4">

                <div id="mortgage-1-wrapper" class="mb-4">
                    <div class="section-header p-2 bg-light border rounded-top cursor-pointer" data-bs-toggle="collapse" data-bs-target="#mortgage1Collapse" aria-expanded="false" aria-controls="mortgage1Collapse">
                        <legend class="mb-0 fs-5"><i class="bi bi-bank me-2"></i> Document Type: Mortgage / Deed of Trust - 1</legend>
                    </div>
                    <div class="collapse section-body p-4 border border-top-0 rounded-bottom" id="mortgage1Collapse">
                        <fieldset class="transaction-section" data-doc-type="Mortgage-1">
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label for="m1-mortgagor" class="form-label">Mortgagor (Borrower):</label>
                                    <input type="text" id="m1-mortgagor" name="m1-mortgagor" class="form-control" data-excel-field="Mtg 1 - Mortgagor" oninput="saveFormData()">
                                </div>
                                <div class="col-md-4">
                                    <label for="m1-mortgagee" class="form-label">Mortgagee (Lender):</label>
                                    <input type="text" id="m1-mortgagee" name="m1-mortgagee" class="form-control" data-excel-field="Mtg 1 - Mortgagee" oninput="saveFormData()">
                                </div>
                                <div class="col-md-4">
                                    <label for="m1-trustee" class="form-label">Trustee (If any):</label>
                                    <input type="text" id="m1-trustee" name="m1-trustee" class="form-control" data-excel-field="Mtg 1 - Trustee" oninput="saveFormData()">
                                </div>
                            </div>
                            <div class="row g-3 my-3">
                                <div class="col-lg-3 col-md-6">
                                    <label for="m1-dated-date" class="form-label">Dated Date:</label>
                                    <input type="date" id="m1-dated-date" name="m1-dated-date" class="form-control" data-excel-field="Mtg 1 - Dated Date" oninput="saveFormData()">
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <label for="m1-recording-date" class="form-label">Recording Date:</label>
                                    <input type="date" id="m1-recording-date" name="m1-recording-date" class="form-control" data-excel-field="Mtg 1 - Recording Date" oninput="saveFormData()">
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <label for="m1-inst-no" class="form-label">Instrument No.:</label>
                                    <input type="text" id="m1-inst-no" name="m1-inst-no" class="form-control" data-excel-field="Mtg 1 - Inst. No." oninput="saveFormData()">
                                </div>
                                <div class="col-lg-3 col-md-6">
                                    <label for="m1-book-page" class="form-label">Book/Page:</label>
                                    <input type="text" id="m1-book-page" name="m1-book-page" class="form-control" data-excel-field="Mtg 1 - Book/Page" oninput="saveFormData()">
                                </div>
                            </div>
                            <div class="row g-3">
                                <div class="col-md-3">
                                    <label for="m1-loan-amount" class="form-label">Loan Amount:</label>
                                    <div class="input-group">
                                        <span class="input-group-text">$</span>
                                        <input type="number" step="0.01" id="m1-loan-amount" name="m1-loan-amount" class="form-control" data-excel-field="Mtg 1 - Loan Amount" oninput="saveFormData()">
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label for="m1-min-no" class="form-label">MIN No.:</label>
                                    <input type="text" id="m1-min-no" name="m1-min-no" class="form-control" data-excel-field="Mtg 1 - MIN No." oninput="saveFormData()">
                                </div>
                                <div class="col-md-6">
                                    <label for="m1-mers-nominee" class="form-label">MERS as Nominee for:</label>
                                    <input type="text" id="m1-mers-nominee" name="m1-mers-nominee" class="form-control" data-excel-field="Mtg 1 - MERS Nominee" oninput="saveFormData()">
                                </div>
                            </div>
                            </fieldset>
                    </div>
                </div>

                <div id="additionalMortgages"></div>
                <div class="text-start mb-4 ps-3">
                    <button type="button" class="btn btn-outline-info btn-sm" onclick="addMortgageSection()">
                        <i class="bi bi-plus-circle me-1"></i> Add Another Mortgage / Deed of Trust
                    </button>
                </div>

                <hr class="my-4">
                
                <div id="additionalPropertyDocs"></div>
                <div class="text-start mb-4 ps-3">
                    <button type="button" class="btn btn-outline-info btn-sm" data-bs-toggle="modal" data-bs-target="#addDocModal">
                        <i class="bi bi-plus-circle me-1"></i> Add Additional Property Document (e.g., Affidavit, POA)
                    </button>
                </div>
                
                <hr class="my-4">

                <div id="additionalNOCs"></div>
                <div class="text-start mb-4 ps-3">
                    <button type="button" class="btn btn-outline-info btn-sm" onclick="addNOCSection()">
                        <i class="bi bi-plus-circle me-1"></i> Add Notice of Commencement
                    </button>
                </div>

                <hr class="my-4">

                <div id="additionalUCCs"></div>
                <div class="text-start mb-4 ps-3">
                    <button type="button" class="btn btn-outline-info btn-sm" onclick="addUCCSection()">
                        <i class="bi bi-plus-circle me-1"></i> Add UCC-1 Financing Statement
                    </button>
                </div>
                
                <div id="additionalUCCContinuations"></div>
                <div class="text-start mb-4 ps-3">
                    <button type="button" class="btn btn-outline-info btn-sm" onclick="addUCCContinuationSection()">
                        <i class="bi bi-plus-circle me-1"></i> Add UCC-3 Continuation/Related
                    </button>
                </div>
                
                <hr class="my-4">
                
                <div id="additionalDivorces"></div>
                <div class="text-start mb-4 ps-3">
                    <button type="button" class="btn btn-outline-info btn-sm" onclick="addDivorceSection()">
                        <i class="bi bi-people-fill me-1"></i> Add Divorce / Lis Pendens
                    </button>
                </div>
                
                <hr class="my-4">
                
                <div id="additionalJudgments"></div>
                <div class="text-start mb-4 ps-3">
                    <button type="button" class="btn btn-outline-info btn-sm" onclick="addJudgmentSection()">
                        <i class="bi bi-exclamation-triangle-fill me-1"></i> Add Judgment / Lien
                    </button>
                </div>

                <div class="mt-5 pt-3 border-top d-flex justify-content-between align-items-center">
                    <div>
                        <button type="button" class="btn btn-success me-2" onclick="exportToPDF()">
                            <i class="bi bi-file-earmark-pdf-fill me-1"></i> Export to PDF
                        </button>
                        <button type="button" class="btn btn-success me-4" onclick="exportToExcel()">
                            <i class="bi bi-file-earmark-excel-fill me-1"></i> Export to Excel
                        </button>
                        <button type="button" class="btn btn-outline-danger btn-sm" onclick="clearLocalData()">
                            <i class="bi bi-trash me-1"></i> Clear Saved Data
                        </button>
                    </div>
                    
                    <div class="form-check form-switch d-flex align-items-center">
                        <input class="form-check-input" type="checkbox" id="darkModeSwitch" role="switch">
                        <label class="form-check-label ms-2" for="darkModeSwitch">
                            <i id="theme-icon" class="bi bi-moon-fill"></i> Dark Mode
                        </label>
                    </div>
                </div>

            </form>
        </div>
    </div>
    
    <div class="modal fade" id="addDocModal" tabindex="-1" aria-labelledby="addDocModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-info text-white">
                    <h5 class="modal-title" id="addDocModalLabel"><i class="bi bi-file-earmark-plus-fill me-2"></i> New Additional Property Related Document</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="text-muted">Enter key details for the document before adding it to the form.</p>
                    <div class="mb-3">
                        <label for="modal-doc-type" class="form-label fw-bold">1. Document Type:</label>
                        <input type="text" id="modal-doc-type" class="form-control" placeholder="e.g., Affidavit, Power of Attorney, Easement">
                    </div>
                    <div class="row g-3">
                        <div class="col-md-6 mb-3">
                            <label for="modal-doc-grantor" class="form-label fw-bold">2. Grantor / First Party:</label>
                            <input type="text" id="modal-doc-grantor" class="form-control" placeholder="Name(s) of the Transferor/Debtor">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="modal-doc-grantee" class="form-label fw-bold">3. Grantee / Second Party:</label>
                            <input type="text" id="modal-doc-grantee" class="form-control" placeholder="Name(s) of the Recipient/Creditor">
                        </div>
                    </div>
                    <div class="row g-3 mb-3">
                        <div class="col-md-6">
                            <label for="modal-doc-dated-date" class="form-label">4. Dated Date (Optional):</label>
                            <input type="date" id="modal-doc-dated-date" class="form-control">
                        </div>
                        <div class="col-md-6">
                            <label for="modal-doc-recording-date" class="form-label">5. Recording Date (Optional):</label>
                            <input type="date" id="modal-doc-recording-date" class="form-control">
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="modal-doc-inst" class="form-label">6. Instrument No. / Book & Page (Optional):</label>
                        <input type="text" id="modal-doc-inst" class="form-control" placeholder="Instrument number or book/page">
                    </div>
                    <div class="mb-3">
                        <label for="modal-doc-comments" class="form-label">7. Notes / Comments (Optional):</label>
                        <textarea id="modal-doc-comments" class="form-control"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-info text-white" onclick="addCustomDocument()">Add Document</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
    
</body>
</html>
